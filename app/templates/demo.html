<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ ë°ëª¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ê¸°ë³¸ í°íŠ¸ ë° íŠ¸ëœì§€ì…˜ */
        body {
            font-family: 'Inter', 'Pretendard', sans-serif;
            background-color: #f8fafc;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tab-btn.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 40;
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 50;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal.active,
        .modal-overlay.active {
            display: block;
        }

        /* ìŠ¤í¬ë¡¤ë°” ë””ìì¸ */
        .modal::-webkit-scrollbar {
            width: 8px;
        }

        .modal::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
        }

        .modal::-webkit-scrollbar-track {
            background-color: #f1f5f9;
        }
    </style>
</head>

<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">ğŸ“ í•™ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ ë°ëª¨</h1>

        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="border-b border-gray-200 mb-6">
            <nav class="flex -mb-px space-x-6">
                <button
                    class="tab-btn active py-4 px-1 border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:outline-none"
                    data-tab="tab-lecture">ê°•ì˜ ê´€ë¦¬</button>
                <button
                    class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:outline-none"
                    data-tab="tab-grade">ì„±ì  ê´€ë¦¬</button>
                <button
                    class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:outline-none"
                    data-tab="tab-course">ê³¼ëª© ë° ê°•ì˜ ì •ë³´</button>
                <button
                    class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:outline-none"
                    data-tab="tab-scholarship">ì¥í•™ìƒ ì„ ë³„</button>
            </nav>
        </div>

        <!-- íƒ­ ì»¨í…ì¸  -->
        <div>
            <!-- ======================= -->
            <!-- 1. ê°•ì˜ ê´€ë¦¬ íƒ­ (ì‹œì—° 1, 2) -->
            <!-- ======================= -->
            <div id="tab-lecture" class="tab-content active space-y-6">
                <h2 class="text-2xl font-semibold text-gray-700">ê°•ì˜ ê´€ë¦¬</h2>

                <!-- 1a. ê°•ì˜ ê°œì„¤ -->
                <div class="p-5 bg-gray-50 rounded-lg border">
                    <h3 class="font-semibold text-lg mb-4">ê°•ì˜ ê°œì„¤ (ì‹œì—° 1: Create)</h3>
                    <form id="form-create-lecture" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="text" id="lecture-semester" placeholder="í•™ê¸° (ì˜ˆ: 2026-1)" class="p-2 border rounded"
                            required>
                        <input type="text" id="lecture-time" placeholder="ê°•ì˜ ì‹œê°„ (ì˜ˆ: ì›”3-4)" class="p-2 border rounded"
                            required>
                        <input type="text" id="lecture-room" placeholder="ê°•ì˜ì‹¤ (ì˜ˆ: ê³µí•™ê´€ 501í˜¸)" class="p-2 border rounded"
                            required>
                        <input type="number" id="lecture-capacity" placeholder="ìˆ˜ê°• ì •ì›" class="p-2 border rounded"
                            required>
                        <input type="text" id="lecture-course-code" placeholder="ê³¼ëª©ì½”ë“œ (ì˜ˆ: CS101)"
                            class="p-2 border rounded" required>
                        <input type="text" id="lecture-prof-id" placeholder="êµìˆ˜ë²ˆí˜¸ (ì˜ˆ: P1001)" class="p-2 border rounded"
                            required>
                        <button type="submit"
                            class="md:col-span-3 p-2 bg-blue-600 text-white rounded font-semibold hover:bg-blue-700 transition">ê°•ì˜
                            ê°œì„¤</button>
                    </form>
                    <div id="result-create-lecture" class="mt-4 p-3 bg-blue-100 text-blue-800 rounded hidden"></div>
                </div>

                <!-- 1b. ê°•ì˜ ëª©ë¡ ì¡°íšŒ (í•„í„°) -->
                <div class="p-5 bg-gray-50 rounded-lg border">
                    <h3 class="font-semibold text-lg mb-4">ê°•ì˜ ëª©ë¡ ì¡°íšŒ (ì‹œì—° 2: Read)</h3>
                    <form id="form-filter-lectures" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <input type="text" id="filter-semester" placeholder="í•™ê¸° (ì˜ˆ: 2025-2)" class="p-2 border rounded">
                        <input type="text" id="filter-course-code" placeholder="ê³¼ëª©ì½”ë“œ (ì˜ˆ: BUS101)"
                            class="p-2 border rounded">
                        <input type="text" id="filter-prof-id" placeholder="êµìˆ˜ë²ˆí˜¸ (ì˜ˆ: P4001)" class="p-2 border rounded">
                        <button type="submit"
                            class="p-2 bg-green-600 text-white rounded font-semibold hover:bg-green-700 transition">ê°•ì˜
                            ì¡°íšŒ</button>
                    </form>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="p-3 text-left">ê°•ì˜ID</th>
                                    <th class="p-3 text-left">í•™ê¸°</th>
                                    <th class="p-3 text-left">ê³¼ëª©ì½”ë“œ</th>
                                    <th class="p-3 text-left">êµìˆ˜ID</th>
                                    <th class="p-3 text-left">ê°•ì˜ì‹¤</th>
                                    <th class="p-3 text-left">ë™ì‘</th>
                                </tr>
                            </thead>
                            <tbody id="table-lectures">
                                <!-- JSë¡œ ë Œë”ë§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ======================= -->
            <!-- 2. ì„±ì  ê´€ë¦¬ íƒ­ (ì‹œì—° 6) -->
            <!-- ======================= -->
            <div id="tab-grade" class="tab-content space-y-6">
                <h2 class="text-2xl font-semibold text-gray-700">ì„±ì  ê´€ë¦¬ (ì‹œì—° 6: Update & Trigger)</h2>
                <div class="p-5 bg-gray-50 rounded-lg border">
                    <h3 class="font-semibold text-lg mb-4">í•™ìƒ ì„±ì  ìˆ˜ì • (í‰ì  ì—°ì‡„ ì—…ë°ì´íŠ¸)</h3>
                    <form id="form-update-grade" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <input type="text" id="grade-student-id" placeholder="í•™ìƒ ID (ì˜ˆ: S2001)"
                            class="p-2 border rounded" required>
                        <input type="text" id="grade-lecture-id" placeholder="ê°•ì˜ ID (ì˜ˆ: 101)" class="p-2 border rounded"
                            required>
                        <input type="text" id="grade-new-grade" placeholder="ìƒˆ ì„±ì  (ì˜ˆ: A+)" class="p-2 border rounded"
                            required>
                        <button type="submit"
                            class="p-2 bg-purple-600 text-white rounded font-semibold hover:bg-purple-700 transition">ì„±ì 
                            ìˆ˜ì •</button>
                    </form>
                    <div id="result-update-grade" class="mt-4 p-3 bg-purple-100 rounded hidden">
                        <h4 class="font-semibold text-purple-800">API ì‘ë‹µ (íŠ¸ë¦¬ê±° ì‘ë™)</h4>
                        <pre class="text-sm text-purple-900 bg-white p-2 rounded overflow-auto"></pre>
                    </div>
                </div>
            </div>

            <!-- ======================= -->
            <!-- 3. ê³¼ëª© ì •ë³´ íƒ­ (ì‹œì—° 3, 4) -->
            <!-- ======================= -->
            <div id="tab-course" class="tab-content space-y-6">
                <h2 class="text-2xl font-semibold text-gray-700">ê³¼ëª© ë° ê°•ì˜ ì •ë³´ ì¡°íšŒ</h2>

                <!-- ë‹´ë‹¹ êµìˆ˜ ì¡°íšŒ -->
                <div class="p-5 bg-gray-50 rounded-lg border">
                    <h3 class="font-semibold text-lg mb-4">ë‹´ë‹¹ êµìˆ˜ ì¡°íšŒ (ê³¼ëª© ì½”ë“œë¡œ)</h3>
                    <form id="form-get-professors" class="flex space-x-4 mb-4">
                        <input type="text" id="info-course-code" placeholder="ê³¼ëª©ì½”ë“œ (ì˜ˆ: CS101)"
                            class="flex-grow p-2 border rounded" required>
                        <button type="submit"
                            class="p-2 bg-cyan-600 text-white rounded font-semibold hover:bg-cyan-700 transition">ë‹´ë‹¹ êµìˆ˜
                            ì¡°íšŒ</button>
                    </form>
                </div>

                <!-- ê°•ì˜ ìƒì„¸ ì¡°íšŒ -->
                <div class="p-5 bg-gray-50 rounded-lg border">
                    <h3 class="font-semibold text-lg mb-4">ê°•ì˜ ìƒì„¸ ì •ë³´ ì¡°íšŒ (ê°•ì˜ IDë¡œ)</h3>
                    <form id="form-get-lecture-details" class="flex space-x-4 mb-4">
                        <input type="number" id="info-lecture-id" placeholder="ê°•ì˜ ID (ì˜ˆ: 101)"
                            class="flex-grow p-2 border rounded" required>
                        <button type="submit"
                            class="p-2 bg-teal-600 text-white rounded font-semibold hover:bg-teal-700 transition">ê°•ì˜ ì •ë³´
                            ì¡°íšŒ</button>
                    </form>
                </div>

                <!-- ì¡°íšŒ ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
                <div id="result-info-area" class="mt-4 p-3 bg-blue-50 rounded hidden">
                    <h4 id="result-info-title" class="font-semibold text-blue-800">ì¡°íšŒ ê²°ê³¼</h4>
                    <div id="result-info-content" class="text-sm bg-white p-2 rounded overflow-auto"></div>
                </div>
            </div>

            <!-- ======================= -->
            <!-- 4. ì¥í•™ìƒ ì„ ë³„ íƒ­ (ì‹œì—° 5) -->
            <!-- ======================= -->
            <div id="tab-scholarship" class="tab-content space-y-6">
                <h2 class="text-2xl font-semibold text-gray-700">ì¥í•™ìƒ ì„ ë³„ (ì‹œì—° 5: Read)</h2>
                <div class="p-5 bg-gray-50 rounded-lg border">
                    <h3 class="font-semibold text-lg mb-4">ì¥í•™ìƒ í›„ë³´ì ì¡°íšŒ</h3>
                    <form id="form-scholarship" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <input type="text" id="scholar-semester" placeholder="í•™ê¸° (ì˜ˆ: 2025-2)" class="p-2 border rounded"
                            required>
                        <input type="number" id="scholar-gpa" placeholder="ìµœì†Œ í‰ì  (ì˜ˆ: 4.0)" step="0.01"
                            class="p-2 border rounded" required>
                        <input type="text" id="scholar-status" placeholder="ì¬í•™ ìƒíƒœ (ì˜ˆ: ì¬í•™)" class="p-2 border rounded"
                            required>
                        <button type="submit"
                            class="p-2 bg-yellow-500 text-white rounded font-semibold hover:bg-yellow-600 transition">í›„ë³´ì
                            ê²€ìƒ‰</button>
                    </form>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="p-3 text-left">í•™ìƒID</th>
                                    <th class="p-3 text-left">ì´ë¦„</th>
                                    <th class="p-3 text-left">í•™ê³¼</th>
                                    <th class="p-3 text-left">ìƒíƒœ</th>
                                    <th class="p-3 text-left">í•™ê¸°</th>
                                    <th class="p-3 text-left">í•™ê¸° í‰ì </th>
                                </tr>
                            </thead>
                            <tbody id="table-scholarship">
                                <!-- JSë¡œ ë Œë”ë§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- ======================= -->
    <!-- ëª¨ë‹¬ (ìˆ˜ê°•ìƒ ëª©ë¡) -->
    <!-- ======================= -->
    <div id="modal-students" class="modal-overlay">
        <div class="modal bg-white rounded-lg shadow-xl w-11/12 md:w-2/3 lg:w-1/2">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-semibold">ê°•ì˜ ìˆ˜ê°•ìƒ ëª©ë¡ (<span id="modal-lecture-id"></span>)</h3>
                <button onclick="closeModal('modal-students')"
                    class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            </div>
            <div class="p-6">
                <table class="min-w-full bg-white border">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="p-3 text-left">í•™ìƒID</th>
                            <th class="p-3 text-left">ì´ë¦„</th>
                            <th class="p-3 text-left">í•™ê³¼</th>
                            <th class="p-3 text-left">í•™ë…„</th>
                            <th class="p-3 text-left">ì„±ì </th>
                        </tr>
                    </thead>
                    <tbody id="table-lecture-students">
                        <!-- JSë¡œ ë Œë”ë§ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ======================= -->
    <!-- ëª¨ë‹¬ (í•™ìƒ ì„±ì í‘œ) -->
    <!-- ======================= -->
    <div id="modal-report" class="modal-overlay">
        <div class="modal bg-white rounded-lg shadow-xl w-11/12 md:w-3/4 lg:w-2/3">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-semibold">í•™ìƒ ì„±ì í‘œ</h3>
                <button onclick="closeModal('modal-report')"
                    class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            </div>
            <div id="report-content" class="p-6 space-y-4">
                <!-- JSë¡œ ë Œë”ë§ -->
            </div>
        </div>
    </div>

    <script>
        // TODO: ì‹¤ì œ ë°±ì—”ë“œ APIê°€ ì¤€ë¹„ë˜ë©´, ì´ íŒŒì¼ ì „ì²´ì˜ 'mockApi' í˜¸ì¶œì„ 'fetch'ë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.
        //       (e.g., `const res = await mockApi(...)` -> `const res = await fetch(...)`)
        // ==================================================================
        // Mock API (ê°€ì§œ API ì„œë²„)
        // ì„œë²„ê°€ ì—†ì–´ë„ API ëª…ì„¸ì„œëŒ€ë¡œ ì‘ë‹µì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤.
        // ==================================================================
        const mockApi = (endpoint, options = {}) => {
            console.log("Mock API Call:", endpoint, options);

            // API ë¼ìš°íŒ…
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    // 1. POST /api/v1/lectures
                    if (endpoint === '/api/v1/lectures' && options.method === 'POST') {
                        const body = JSON.parse(options.body);
                        resolve({
                            ok: true,
                            status: 201,
                            json: () => Promise.resolve({
                                "lecture_id": Math.floor(Math.random() * 100) + 100, // ì„ì˜ì˜ ID
                                "semester": body.semester,
                                "course_code": body.course_code,
                                "professor_id": body.professor_id,
                                "message": "ê°•ì˜ê°€ ì„±ê³µì ìœ¼ë¡œ ê°œì„¤ë˜ì—ˆìŠµë‹ˆë‹¤."
                            })
                        });
                    }

                    // 2. GET /api/v1/lectures (í•„í„°ë§)
                    else if (endpoint.startsWith('/api/v1/lectures') && (!options.method || options.method === 'GET')) {
                        // 2a. ê°•ì˜ ìƒì„¸ ì¡°íšŒ (GET /api/v1/lectures/{id})
                        if (endpoint.match(/\/api\/v1\/lectures\/(\d+)$/)) {
                            resolve({
                                ok: true, status: 200, json: () => Promise.resolve({
                                    "lecture_id": 101, "semester": "2025-2", "lecture_time": "ì›”3-4",
                                    "lecture_room": "ê²½ì˜ê´€ 303í˜¸", "capacity": 50, "course_code": "BUS101",
                                    "professor_id": "P4001"
                                })
                            });
                        }
                        // 2b. ê°•ì˜ ìˆ˜ê°•ìƒ ì¡°íšŒ (GET /api/v1/lectures/{id}/students)
                        else if (endpoint.match(/\/api\/v1\/lectures\/\d+\/students/)) {
                            resolve({
                                ok: true, status: 200, json: () => Promise.resolve([
                                    { "student_id": "S1001", "student_name": "ê¹€ë¯¼ì¤€", "department_name": "ì»´í“¨í„°ê³µí•™ê³¼", "grade_year": 3, "grade_received": "A+" },
                                    { "student_id": "S1003", "student_name": "ìµœìœ ë¦¬", "department_name": "ì»´í“¨í„°ê³µí•™ê³¼", "grade_year": 3, "grade_received": "A0" }
                                ])
                            });
                        }
                        // 2c. ê°•ì˜ ëª©ë¡ ì¡°íšŒ (GET /api/v1/lectures)
                        else {
                            resolve({
                                ok: true, status: 200, json: () => Promise.resolve([
                                    { "lecture_id": 101, "semester": "2025-2", "lecture_time": "ì›”3,4", "lecture_room": "ê²½ì˜ê´€ 303í˜¸", "capacity": 50, "course_code": "BUS101", "professor_id": "P4001" },
                                    { "lecture_id": 103, "semester": "2025-2", "lecture_time": "ìˆ˜5,6", "lecture_room": "ê²½ì˜ê´€ 303í˜¸", "capacity": 40, "course_code": "BUS201", "professor_id": "P4001" }
                                ])
                            });
                        }
                    }

                    // 3. GET /api/v1/students/{id}/report
                    else if (endpoint.match(/\/api\/v1\/students\/.+\/report/)) {
                        resolve({
                            ok: true, status: 200, json: () => Promise.resolve({
                                "student_id": "S1001", "student_name": "ê¹€ë¯¼ì¤€", "department_name": "ì»´í“¨í„°ê³µí•™ê³¼", "overall_gpa": 4.15,
                                "semesters": [
                                    {
                                        "semester": "2025-1", "semester_gpa": 4.25, "earned_credits": 18, "courses": [
                                            { "course_name": "ë°ì´í„°ë² ì´ìŠ¤", "credits": 3, "grade": "A+" },
                                            { "course_name": "ìš´ì˜ì²´ì œ", "credits": 3, "grade": "A0" }
                                        ]
                                    },
                                    {
                                        "semester": "2025-2", "semester_gpa": 4.05, "earned_credits": 18, "courses": [
                                            { "course_name": "ìë£Œêµ¬ì¡°", "credits": 3, "grade": "A0" }
                                        ]
                                    }
                                ]
                            })
                        });
                    }

                    // 4. GET /api/v1/courses/{code}/professors
                    else if (endpoint.match(/\/api\/v1\/courses\/.+\/professors/)) {
                        resolve({
                            ok: true, status: 200, json: () => Promise.resolve([
                                { "professor_id": "P1001", "professor_name": "ì´ì„±ì§„", "email": "sjlee@mju.ac.kr", "office_room": "ê³µí•™ê´€ 505í˜¸" },
                                { "professor_id": "P1002", "professor_name": "ë°•ì² ìˆ˜", "email": "cspak@mju.ac.kr", "office_room": "ê³µí•™ê´€ 506í˜¸" }
                            ])
                        });
                    }

                    // 5. GET /api/v1/courses/{code}/students -> This endpoint is no longer used in the UI
                    else if (endpoint.match(/\/api\/v1\/courses\/.+\/students/)) {
                        resolve({
                            ok: true, status: 200, json: () => Promise.resolve([
                                { "student_id": "S1001", "student_name": "ê¹€ë¯¼ì¤€", "department_name": "ì»´í“¨í„°ê³µí•™ê³¼", "grade_year": 3 },
                                { "student_id": "S1003", "student_name": "ìµœìœ ë¦¬", "department_name": "ì»´í“¨í„°ê³µí•™ê³¼", "grade_year": 3 },
                                { "student_id": "S2001", "student_name": "ë°•ì§€í›ˆ", "department_name": "ê²½ì˜í•™ê³¼", "grade_year": 2 }
                            ])
                        });
                    }

                    // 6. GET /api/v1/scholarship/candidates
                    else if (endpoint.startsWith('/api/v1/scholarship/candidates')) {
                        resolve({
                            ok: true, status: 200, json: () => Promise.resolve([
                                { "student_id": "S2001", "student_name": "ë°•ì§€í›ˆ", "department_name": "ê²½ì˜í•™ê³¼", "status": "ì¬í•™", "semester": "2025-2", "semester_gpa": 4.25 },
                                { "student_id": "S3001", "student_name": "ì •ì˜ˆìŠ¬", "department_name": "ë””ìì¸í•™ê³¼", "status": "ì¬í•™", "semester": "2025-2", "semester_gpa": 4.20 }
                            ])
                        });
                    }

                    // 7. PATCH /api/v1/students/{sid}/lectures/{lid}/grade
                    else if (endpoint.match(/\/api\/v1\/students\/.+\/lectures\/.+\/grade/) && options.method === 'PATCH') {
                        const body = JSON.parse(options.body);
                        resolve({
                            ok: true, status: 200, json: () => Promise.resolve({
                                "student_id": "S2001",
                                "lecture_id": "101",
                                "updated_grade": body.grade,
                                "message": "ì„±ì ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìœ¼ë©°, í‰ì ì´ ì—°ì‡„ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                                "updated_semester_gpa": (Math.random() * (4.5 - 3.5) + 3.5).toFixed(2), // 3.5 ~ 4.5 ì‚¬ì´ ëœë¤
                                "updated_overall_gpa": (Math.random() * (4.0 - 3.0) + 3.0).toFixed(2)  // 3.0 ~ 4.0 ì‚¬ì´ ëœë¤
                            })
                        });
                    }

                    else {
                        reject(new Error("Mock API Not Found: " + endpoint));
                    }
                }, 300); // 300ms ì§€ì—°ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜
            });
        };

        // ==================================================================
        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        // ==================================================================
        const showModal = (id) => {
            const overlay = document.getElementById(id);
            if (!overlay) return;
            const modal = overlay.querySelector('.modal');
            overlay.classList.add('active');
            if (modal) modal.classList.add('active');
        };
        const closeModal = (id) => {
            const overlay = document.getElementById(id);
            if (!overlay) return;
            const modal = overlay.querySelector('.modal');
            overlay.classList.remove('active');
            if (modal) modal.classList.remove('active');
        };

        const showResult = (elementId, title, data) => {
            const el = document.getElementById(elementId);
            el.querySelector('h4').textContent = title;
            el.querySelector('pre').textContent = JSON.stringify(data, null, 2);
            el.classList.remove('hidden');
        };

        // ==================================================================
        // DOM ë¡œë“œ í›„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
        // ==================================================================
        document.addEventListener('DOMContentLoaded', () => {

            // -----------------------
            // íƒ­ ë¡œì§
            // -----------------------
            const tabs = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    // í´ë¦­ëœ íƒ­ í™œì„±í™”
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab).classList.add('active');
                });
            });

            // -----------------------
            // 1. ê°•ì˜ ê´€ë¦¬ íƒ­ (ì‹œì—° 1, 2)
            // -----------------------
            const formCreateLecture = document.getElementById('form-create-lecture');
            const resultCreateLecture = document.getElementById('result-create-lecture');

            formCreateLecture.addEventListener('submit', async (e) => {
                e.preventDefault();
                const data = {
                    "semester": document.getElementById('lecture-semester').value,
                    "lecture_time": document.getElementById('lecture-time').value,
                    "lecture_room": document.getElementById('lecture-room').value,
                    "capacity": parseInt(document.getElementById('lecture-capacity').value),
                    "course_code": document.getElementById('lecture-course-code').value,
                    "professor_id": document.getElementById('lecture-prof-id').value
                };

                try {
                    const res = await fetch('/api/v1/lectures', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await res.json();

                    if (!res.ok) {
                        throw new Error(result.detail || 'ê°•ì˜ ê°œì„¤ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }

                    resultCreateLecture.textContent = `ê°•ì˜ ID ${result.lecture_id}ê°€ ì„±ê³µì ìœ¼ë¡œ ê°œì„¤ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                    resultCreateLecture.classList.remove('hidden');
                    formCreateLecture.reset();
                } catch (err) {
                    resultCreateLecture.textContent = `ì˜¤ë¥˜ ë°œìƒ: ${err.message}`;
                    resultCreateLecture.classList.remove('hidden');
                }
            });

            const formFilterLectures = document.getElementById('form-filter-lectures');
            const tableLectures = document.getElementById('table-lectures');

            formFilterLectures.addEventListener('submit', async (e) => {
                e.preventDefault();
                const params = new URLSearchParams();
                const semester = document.getElementById('filter-semester').value;
                const course_code = document.getElementById('filter-course-code').value;
                const prof_id = document.getElementById('filter-prof-id').value;

                if (semester) params.append('semester', semester);
                if (course_code) params.append('course_code', course_code);
                if (prof_id) params.append('professor_id', prof_id);

                try {
                    const res = await fetch(`/api/v1/lectures?${params.toString()}`);
                    const data = await res.json();

                    if (!res.ok) {
                        throw new Error(data.detail || 'ê°•ì˜ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }

                    tableLectures.innerHTML = ''; // í…Œì´ë¸” ì´ˆê¸°í™”
                    if (data.length === 0) {
                        tableLectures.innerHTML = '<tr><td colspan="6" class="p-3 text-center text-gray-500">ì¡°íšŒëœ ê°•ì˜ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                        return;
                    }

                    data.forEach(lecture => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                    <td class="p-3 border-t">${lecture.lecture_id}</td>
                    <td class="p-3 border-t">${lecture.semester}</td>
                    <td class="p-3 border-t">${lecture.course_code}</td>
                    <td class="p-3 border-t">${lecture.professor_id}</td>
                    <td class="p-3 border-t">${lecture.lecture_room}</td>
                    <td class="p-3 border-t">
                        <button class="text-sm bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
                                onclick="viewStudents('${lecture.lecture_id}')">ìˆ˜ê°•ìƒ ë³´ê¸°</button>
                    </td>
                `;
                        tableLectures.appendChild(row);
                    });
                } catch (err) {
                    tableLectures.innerHTML = `<tr><td colspan="6" class="p-3 text-center text-red-500">ì˜¤ë¥˜: ${err.message}</td></tr>`;
                }
            });

            // -----------------------
            // 2. ì„±ì  ê´€ë¦¬ íƒ­ (ì‹œì—° 6)
            // -----------------------
            const formUpdateGrade = document.getElementById('form-update-grade');
            const resultUpdateGrade = document.getElementById('result-update-grade');

            formUpdateGrade.addEventListener('submit', async (e) => {
                e.preventDefault();
                const studentId = document.getElementById('grade-student-id').value;
                const lectureId = document.getElementById('grade-lecture-id').value;
                const grade = document.getElementById('grade-new-grade').value;

                try {
                    const res = await mockApi(`/api/v1/students/${studentId}/lectures/${lectureId}/grade`, {
                        method: 'PATCH',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ "grade": grade })
                    });
                    const data = await res.json();
                    showResult('result-update-grade', 'API ì‘ë‹µ (íŠ¸ë¦¬ê±° ì‘ë™)', data);
                } catch (err) {
                    showResult('result-update-grade', 'ì˜¤ë¥˜ ë°œìƒ', { error: err.message });
                }
            });

            // -----------------------
            // 3. ê³¼ëª© ì •ë³´ íƒ­
            // -----------------------
            const formGetProfessors = document.getElementById('form-get-professors');
            const formGetLectureDetails = document.getElementById('form-get-lecture-details');
            const resultInfoArea = document.getElementById('result-info-area');
            const resultInfoTitle = document.getElementById('result-info-title');
            const resultInfoContent = document.getElementById('result-info-content');

                        // ë‹´ë‹¹ êµìˆ˜ ì¡°íšŒ
                        formGetProfessors.addEventListener('submit', async (e) => {
                            e.preventDefault();
                            const courseCode = document.getElementById('info-course-code').value;
                            if (!courseCode) { alert('ê³¼ëª©ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
            
                            try {
                                const res = await mockApi(`/api/v1/courses/${courseCode}/professors`);
                                const data = await res.json();
            
                                if (!res.ok) {
                                    throw new Error(data.detail || 'ë‹´ë‹¹ êµìˆ˜ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                                }
            
                                resultInfoTitle.textContent = `[${courseCode}] ë‹´ë‹¹ êµìˆ˜ ì¡°íšŒ ê²°ê³¼`;
                                
                                if (data.length === 0) {
                                    resultInfoContent.innerHTML = '<p class="p-4 text-center text-gray-500">í•´ë‹¹ ê³¼ëª©ì„ ë‹´ë‹¹í•˜ëŠ” êµìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                                } else {
                                    resultInfoContent.innerHTML = `
                                        <table class="min-w-full text-sm">
                                            <thead class="bg-gray-100">
                                                <tr>
                                                    <th class="p-2 text-left">êµìˆ˜ ID</th>
                                                    <th class="p-2 text-left">ì´ë¦„</th>
                                                    <th class="p-2 text-left">ì´ë©”ì¼</th>
                                                    <th class="p-2 text-left">ì—°êµ¬ì‹¤</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${data.map(prof => `
                                                    <tr class="border-t">
                                                        <td class="p-2">${prof.professor_id}</td>
                                                        <td class="p-2">${prof.professor_name}</td>
                                                        <td class="p-2">${prof.email}</td>
                                                        <td class="p-2">${prof.office_room}</td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                        </table>
                                    `;
                                }
                                resultInfoArea.classList.remove('hidden');
            
                            } catch (err) {
                                resultInfoTitle.textContent = 'ì˜¤ë¥˜ ë°œìƒ';
                                resultInfoContent.innerHTML = `<p class="p-4 text-red-500">${err.message}</p>`;
                                resultInfoArea.classList.remove('hidden');
                            }
                        });
                        // ê°•ì˜ ìƒì„¸ ì •ë³´ ì¡°íšŒ
                        formGetLectureDetails.addEventListener('submit', async (e) => {
                            e.preventDefault();
                            const lectureId = document.getElementById('info-lecture-id').value;
                            if (!lectureId) { alert('ê°•ì˜ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
            
                            try {
                                const res = await fetch(`/api/v1/lectures/${lectureId}`);
                                const data = await res.json();
            
                                 if (!res.ok) {
                                    throw new Error(data.detail || 'ê°•ì˜ ì •ë³´ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                                }
            
                                resultInfoTitle.textContent = `[ê°•ì˜ ID: ${lectureId}] ìƒì„¸ ì •ë³´`;
                                resultInfoContent.innerHTML = `
                                    <table class="min-w-full text-sm">
                                        <tbody class="bg-white">
                                            <tr><td class="p-2 font-semibold border-t">ê°•ì˜ ID</td><td class="p-2 border-t">${data.lecture_id}</td></tr>
                                            <tr><td class="p-2 font-semibold border-t">í•™ê¸°</td><td class="p-2 border-t">${data.semester}</td></tr>
                                            <tr><td class="p-2 font-semibold border-t">ê°•ì˜ ì‹œê°„</td><td class="p-2 border-t">${data.lecture_time}</td></tr>
                                            <tr><td class="p-2 font-semibold border-t">ê°•ì˜ì‹¤</td><td class="p-2 border-t">${data.lecture_room}</td></tr>
                                            <tr><td class="p-2 font-semibold border-t">ìˆ˜ê°• ì •ì›</td><td class="p-2 border-t">${data.capacity}</td></tr>
                                            <tr><td class="p-2 font-semibold border-t">ê³¼ëª© ì½”ë“œ</td><td class="p-2 border-t">${data.course_code}</td></tr>
                                            <tr><td class="p-2 font-semibold border-t">êµìˆ˜ ID</td><td class="p-2 border-t">${data.professor_id}</td></tr>
                                        </tbody>
                                    </table>
                                `;
                                resultInfoArea.classList.remove('hidden');
            
                            } catch (err) {
                                resultInfoTitle.textContent = 'ì˜¤ë¥˜ ë°œìƒ';
                                resultInfoContent.innerHTML = `<p class="p-4 text-red-500">${err.message}</p>`;
                                resultInfoArea.classList.remove('hidden');
            }
                        });
            // -----------------------
            // 4. ì¥í•™ìƒ ì„ ë³„ íƒ­ (ì‹œì—° 5)
            // -----------------------
            const formScholarship = document.getElementById('form-scholarship');
            const tableScholarship = document.getElementById('table-scholarship');

            formScholarship.addEventListener('submit', async (e) => {
                e.preventDefault();
                const params = new URLSearchParams();
                params.append('semester', document.getElementById('scholar-semester').value);
                params.append('gpa_threshold', document.getElementById('scholar-gpa').value);
                params.append('status', document.getElementById('scholar-status').value);

                try {
                    const res = await mockApi(`/api/v1/scholarship/candidates?${params.toString()}`);
                    const data = await res.json();

                    tableScholarship.innerHTML = ''; // í…Œì´ë¸” ì´ˆê¸°í™”
                    if (data.length === 0) {
                        tableScholarship.innerHTML = '<tr><td colspan="6" class="p-3 text-center text-gray-500">í•´ë‹¹ ì¡°ê±´ì˜ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                        return;
                    }

                    data.forEach(student => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                    <td class="p-3 border-t">${student.student_id}</td>
                    <td class="p-3 border-t">${student.student_name}</td>
                    <td class="p-3 border-t">${student.department_name}</td>
                    <td class="p-3 border-t">${student.status}</td>
                    <td class="p-3 border-t">${student.semester}</td>
                    <td class="p-3 border-t font-semibold text-red-600">${student.semester_gpa}</td>
                `;
                        tableScholarship.appendChild(row);
                    });
                } catch (err) {
                    tableScholarship.innerHTML = `<tr><td colspan="6" class="p-3 text-center text-red-500">ì˜¤ë¥˜: ${err.message}</td></tr>`;
                }
            });
        });

        // ==================================================================
        // ëª¨ë‹¬ì„ ìœ„í•œ ì „ì—­ í•¨ìˆ˜ (ë™ì  ìƒì„±ëœ ë²„íŠ¼ì—ì„œ í˜¸ì¶œ)
        // ==================================================================
        async function viewStudents(lectureId) {
            document.getElementById('modal-lecture-id').textContent = lectureId;
            const tableBody = document.getElementById('table-lecture-students');
            tableBody.innerHTML = '<tr><td colspan="5" class="p-3 text-center">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td></tr>';
            showModal('modal-students');

            try {
                const res = await fetch(`/api/v1/lectures/${lectureId}/students`);
                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.detail || 'ìˆ˜ê°•ìƒ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }

                tableBody.innerHTML = '';
                if (data.length === 0) {
                    tableBody.innerHTML = '<tr><td colspan="5" class="p-3 text-center text-gray-500">ìˆ˜ê°•ìƒì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    return;
                }

                data.forEach(student => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                <td class="p-3 border-t">
                    <a href="#" onclick="viewReport('${student.student_id}', event)" 
                       class="text-blue-600 hover:underline">${student.student_id}</a>
                </td>
                <td class="p-3 border-t">${student.student_name}</td>
                <td class="p-3 border-t">${student.department_name}</td>
                <td class="p-3 border-t">${student.grade_year}</td>
                <td class="p-3 border-t">
                    <div class="flex items-center space-x-2">
                        <input type="text" id="grade-input-${lectureId}-${student.student_id}" value="${student.grade_received}" class="p-1 border rounded w-20 text-center">
                        <button onclick="updateGrade('${lectureId}', '${student.student_id}', this)" class="text-sm bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 transition-colors">ìˆ˜ì •</button>
                    </div>
                </td>
            `;
                    tableBody.appendChild(row);
                });
            } catch (err) {
                tableBody.innerHTML = `<tr><td colspan="5" class="p-3 text-center text-red-500">ì˜¤ë¥˜: ${err.message}</td></tr>`;
            }
        }

        async function updateGrade(lectureId, studentId, button) {
            const input = document.getElementById(`grade-input-${lectureId}-${studentId}`);
            const newGrade = input.value.trim();

            if (!newGrade) {
                alert('ì„±ì ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            const originalButtonText = 'ìˆ˜ì •';
            button.textContent = 'ì €ì¥...';
            button.disabled = true;

            try {
                const res = await mockApi(`/api/v1/students/${studentId}/lectures/${lectureId}/grade`, {
                    method: 'PATCH',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ "grade": newGrade })
                });
                const data = await res.json();

                input.value = data.updated_grade;
                button.textContent = 'ì„±ê³µ';
                button.classList.remove('bg-green-600', 'hover:bg-green-700');
                button.classList.add('bg-blue-500');

                setTimeout(() => {
                    button.textContent = originalButtonText;
                    button.disabled = false;
                    button.classList.remove('bg-blue-500');
                    button.classList.add('bg-green-600', 'hover:bg-green-700');
                }, 2000);

            } catch (err) {
                alert(`ì˜¤ë¥˜ ë°œìƒ: ${err.message}`);
                button.textContent = originalButtonText;
                button.disabled = false;
            }
        }

        async function viewReport(studentId, event) {
            if (event) event.preventDefault();

            const contentEl = document.getElementById('report-content');
            contentEl.innerHTML = '<div class="text-center p-8">ì„±ì í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
            showModal('modal-report');

            try {
                const res = await mockApi(`/api/v1/students/${studentId}/report`);
                const data = await res.json();

                let html = `
            <div class="mb-4">
                <h4 class="text-xl font-bold">${data.student_name} (${data.student_id})</h4>
                <p class="text-gray-600">${data.department_name}</p>
                <p class="text-lg font-semibold text-blue-600">ì „ì²´ í‰ì : ${data.overall_gpa}</p>
            </div>
        `;

                data.semesters.forEach(semester => {
                    html += `
                <div class="mb-6 p-4 border rounded-lg bg-gray-50">
                    <h5 class="text-lg font-semibold">${semester.semester} í•™ê¸°</h5>
                    <p class="text-md text-gray-700">í•™ê¸° í‰ì : <span class="font-bold text-red-600">${semester.semester_gpa}</span> (ì·¨ë“ í•™ì : ${semester.earned_credits})</p>
                    <table class="mt-2 min-w-full text-sm">
                        <thead class="bg-gray-200">
                            <tr>
                                <th class="p-2 text-left">ê³¼ëª©ëª…</th>
                                <th class="p-2 text-left">í•™ì </th>
                                <th class="p-2 text-left">ì„±ì </th>
                            </tr>
                        </thead>
                        <tbody>
                            ${semester.courses.map(course => `
                                <tr>
                                    <td class="p-2 border-t">${course.course_name}</td>
                                    <td class="p-2 border-t">${course.credits}</td>
                                    <td class="p-2 border-t">${course.grade}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
                });

                contentEl.innerHTML = html;

            } catch (err) {
                contentEl.innerHTML = `<div class="text-center p-8 text-red-500">ì˜¤ë¥˜ ë°œìƒ: ${err.message}</div>`;
            }
        }
    </script>

</body>

</html>